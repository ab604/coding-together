<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Data wrangling II | Coding togetheR</title>
  <meta name="description" content="Materials for the Coding TogetheR workshops" />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Data wrangling II | Coding togetheR" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://ab604.github.io/docs/coding-together-2019/" />
  <meta property="og:image" content="https://ab604.github.io/docs/coding-together-2019/img/Carrick-bend-Guten-Verrill-modified.png" />
  <meta property="og:description" content="Materials for the Coding TogetheR workshops" />
  <meta name="github-repo" content="ab604/coding-together" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Data wrangling II | Coding togetheR" />
  <meta name="twitter:site" content="@alistair604" />
  <meta name="twitter:description" content="Materials for the Coding TogetheR workshops" />
  <meta name="twitter:image" content="https://ab604.github.io/docs/coding-together-2019/img/Carrick-bend-Guten-Verrill-modified.png" />

<meta name="author" content="Alistair Bailey" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-wrangle-1.html"/>
<link rel="next" href="functions.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Coding togetheR</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#r-and-rstudio"><i class="fa fa-check"></i>R and RStudio</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#who-is-coding-together-for"><i class="fa fa-check"></i>Who is coding togetheR for?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#code-of-conduct"><i class="fa fa-check"></i>Code of conduct</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>1</b> Getting started</a><ul>
<li class="chapter" data-level="1.1" data-path="getting-started.html"><a href="getting-started.html#coding-is-for-everyone"><i class="fa fa-check"></i><b>1.1</b> Coding is for everyone</a></li>
<li class="chapter" data-level="1.2" data-path="getting-started.html"><a href="getting-started.html#a-little-background-and-philosophy"><i class="fa fa-check"></i><b>1.2</b> A little background and philosophy</a><ul>
<li class="chapter" data-level="1.2.1" data-path="getting-started.html"><a href="getting-started.html#what-is-r"><i class="fa fa-check"></i><b>1.2.1</b> What is R?</a></li>
<li class="chapter" data-level="1.2.2" data-path="getting-started.html"><a href="getting-started.html#why-learn-to-code-at-all"><i class="fa fa-check"></i><b>1.2.2</b> Why learn to code at all?</a></li>
<li class="chapter" data-level="1.2.3" data-path="getting-started.html"><a href="getting-started.html#a-little-goes-a-long-way"><i class="fa fa-check"></i><b>1.2.3</b> A little goes a long way</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="getting-started.html"><a href="getting-started.html#rstudio"><i class="fa fa-check"></i><b>1.3</b> RStudio</a><ul>
<li class="chapter" data-level="1.3.1" data-path="getting-started.html"><a href="getting-started.html#what-is-real"><i class="fa fa-check"></i><b>1.3.1</b> What is real?</a></li>
<li class="chapter" data-level="1.3.2" data-path="getting-started.html"><a href="getting-started.html#file-structure"><i class="fa fa-check"></i><b>1.3.2</b> Where am I?</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="getting-started.html"><a href="getting-started.html#install-packages"><i class="fa fa-check"></i><b>1.4</b> Installing and loading packages</a></li>
<li class="chapter" data-level="1.5" data-path="getting-started.html"><a href="getting-started.html#functions-1"><i class="fa fa-check"></i><b>1.5</b> Using functions</a></li>
<li class="chapter" data-level="1.6" data-path="getting-started.html"><a href="getting-started.html#getting-help"><i class="fa fa-check"></i><b>1.6</b> Getting help</a><ul>
<li class="chapter" data-level="1.6.1" data-path="getting-started.html"><a href="getting-started.html#using-to-access-r-function-help-pages"><i class="fa fa-check"></i><b>1.6.1</b> Using <code>?</code> to access R function help pages</a></li>
<li class="chapter" data-level="1.6.2" data-path="getting-started.html"><a href="getting-started.html#using-google-to-find-r-answers"><i class="fa fa-check"></i><b>1.6.2</b> Using Google to find R answers</a></li>
<li class="chapter" data-level="1.6.3" data-path="getting-started.html"><a href="getting-started.html#asking-questions"><i class="fa fa-check"></i><b>1.6.3</b> Asking questions</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="getting-started.html"><a href="getting-started.html#workflow"><i class="fa fa-check"></i><b>1.7</b> A project orientated workflow</a><ul>
<li class="chapter" data-level="1.7.1" data-path="getting-started.html"><a href="getting-started.html#rstudio-projects"><i class="fa fa-check"></i><b>1.7.1</b> RStudio Projects</a></li>
<li class="chapter" data-level="1.7.2" data-path="getting-started.html"><a href="getting-started.html#r-notebooks-and-r-scripts"><i class="fa fa-check"></i><b>1.7.2</b> R notebooks and R scripts</a></li>
<li class="chapter" data-level="1.7.3" data-path="getting-started.html"><a href="getting-started.html#here"><i class="fa fa-check"></i><b>1.7.3</b> Level up with the <code>here</code> package</a></li>
<li class="chapter" data-level="1.7.4" data-path="getting-started.html"><a href="getting-started.html#names"><i class="fa fa-check"></i><b>1.7.4</b> Naming things</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="getting-started.html"><a href="getting-started.html#tidy-data"><i class="fa fa-check"></i><b>1.8</b> The tidyverse and tidy data</a></li>
<li class="chapter" data-level="1.9" data-path="getting-started.html"><a href="getting-started.html#r-atoms"><i class="fa fa-check"></i><b>1.9</b> Atoms of R</a></li>
<li class="chapter" data-level="1.10" data-path="getting-started.html"><a href="getting-started.html#assignment"><i class="fa fa-check"></i><b>1.10</b> Assigning objects</a><ul>
<li class="chapter" data-level="1.10.1" data-path="getting-started.html"><a href="getting-started.html#indexing-and-subsetting"><i class="fa fa-check"></i><b>1.10.1</b> Indexing and subsetting</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="getting-started.html"><a href="getting-started.html#lists-matrices-and-arrays"><i class="fa fa-check"></i><b>1.11</b> Lists, matrices and arrays</a><ul>
<li class="chapter" data-level="1.11.1" data-path="getting-started.html"><a href="getting-started.html#matrices-and-arrays"><i class="fa fa-check"></i><b>1.11.1</b> Matrices and arrays</a></li>
</ul></li>
<li class="chapter" data-level="1.12" data-path="getting-started.html"><a href="getting-started.html#factors"><i class="fa fa-check"></i><b>1.12</b> Factors</a></li>
<li class="chapter" data-level="1.13" data-path="getting-started.html"><a href="getting-started.html#data-frames"><i class="fa fa-check"></i><b>1.13</b> Data frames</a><ul>
<li class="chapter" data-level="1.13.1" data-path="getting-started.html"><a href="getting-started.html#attributes"><i class="fa fa-check"></i><b>1.13.1</b> Attributes</a></li>
</ul></li>
<li class="chapter" data-level="1.14" data-path="getting-started.html"><a href="getting-started.html#plotting-data"><i class="fa fa-check"></i><b>1.14</b> Plotting data</a></li>
<li class="chapter" data-level="1.15" data-path="getting-started.html"><a href="getting-started.html#exporting-data"><i class="fa fa-check"></i><b>1.15</b> Exporting data</a><ul>
<li class="chapter" data-level="1.15.1" data-path="getting-started.html"><a href="getting-started.html#readr"><i class="fa fa-check"></i><b>1.15.1</b> readr</a></li>
<li class="chapter" data-level="1.15.2" data-path="getting-started.html"><a href="getting-started.html#ggsave"><i class="fa fa-check"></i><b>1.15.2</b> ggsave</a></li>
<li class="chapter" data-level="1.15.3" data-path="getting-started.html"><a href="getting-started.html#exercise"><i class="fa fa-check"></i><b>1.15.3</b> Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-wrangle-1.html"><a href="data-wrangle-1.html"><i class="fa fa-check"></i><b>2</b> Data wrangling I</a><ul>
<li class="chapter" data-level="2.1" data-path="data-wrangle-1.html"><a href="data-wrangle-1.html#data-organisation-in-spreadsheets"><i class="fa fa-check"></i><b>2.1</b> Data organisation in spreadsheets</a><ul>
<li class="chapter" data-level="2.1.1" data-path="data-wrangle-1.html"><a href="data-wrangle-1.html#flat-formats-and-excel-files"><i class="fa fa-check"></i><b>2.1.1</b> Flat formats and Excel files</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-wrangle-1.html"><a href="data-wrangle-1.html#portal-project"><i class="fa fa-check"></i><b>2.2</b> The Portal Project data</a><ul>
<li class="chapter" data-level="2.2.1" data-path="data-wrangle-1.html"><a href="data-wrangle-1.html#downloading-and-importing-the-data"><i class="fa fa-check"></i><b>2.2.1</b> Downloading and importing the data</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-wrangle-1.html"><a href="data-wrangle-1.html#dplyr"><i class="fa fa-check"></i><b>2.3</b> <code>dplyr</code></a><ul>
<li class="chapter" data-level="2.3.1" data-path="data-wrangle-1.html"><a href="data-wrangle-1.html#filter-rows-with-filter"><i class="fa fa-check"></i><b>2.3.1</b> Filter rows with <code>filter()</code></a></li>
<li class="chapter" data-level="2.3.2" data-path="data-wrangle-1.html"><a href="data-wrangle-1.html#arrange-rows-with-arrange"><i class="fa fa-check"></i><b>2.3.2</b> Arrange rows with <code>arrange()</code></a></li>
<li class="chapter" data-level="2.3.3" data-path="data-wrangle-1.html"><a href="data-wrangle-1.html#select-columns-with-select"><i class="fa fa-check"></i><b>2.3.3</b> Select columns with <code>select()</code></a></li>
<li class="chapter" data-level="2.3.4" data-path="data-wrangle-1.html"><a href="data-wrangle-1.html#create-new-variables-with-mutate"><i class="fa fa-check"></i><b>2.3.4</b> Create new variables with <code>mutate()</code></a></li>
<li class="chapter" data-level="2.3.5" data-path="data-wrangle-1.html"><a href="data-wrangle-1.html#grouped-summaries-with-group_by-and-summarise"><i class="fa fa-check"></i><b>2.3.5</b> Grouped summaries with <code>group_by()</code> and <code>summarise()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-wrangle-1.html"><a href="data-wrangle-1.html#using-dpylr-to-explore-the-effect-of-kangaroo-rat-exclusion-on-granivore-populations"><i class="fa fa-check"></i><b>2.4</b> Using <code>dpylr</code> to explore the effect of Kangaroo Rat exclusion on Granivore populations</a><ul>
<li class="chapter" data-level="2.4.1" data-path="data-wrangle-1.html"><a href="data-wrangle-1.html#re-cap-of-filter-and-mutate"><i class="fa fa-check"></i><b>2.4.1</b> Re-cap of <code>filter()</code> and <code>mutate()</code></a></li>
<li class="chapter" data-level="2.4.2" data-path="data-wrangle-1.html"><a href="data-wrangle-1.html#use-lubridate-to-create-new-time-variables"><i class="fa fa-check"></i><b>2.4.2</b> Use <code>lubridate</code> to create new time variables</a></li>
<li class="chapter" data-level="2.4.3" data-path="data-wrangle-1.html"><a href="data-wrangle-1.html#group-and-summarise-the-data-into-quarterly-observations"><i class="fa fa-check"></i><b>2.4.3</b> Group and summarise the data into quarterly observations</a></li>
<li class="chapter" data-level="2.4.4" data-path="data-wrangle-1.html"><a href="data-wrangle-1.html#create-a-plot-with-ggplot"><i class="fa fa-check"></i><b>2.4.4</b> Create a plot with <code>ggplot</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-wrangle-2.html"><a href="data-wrangle-2.html"><i class="fa fa-check"></i><b>3</b> Data wrangling II</a><ul>
<li class="chapter" data-level="3.1" data-path="data-wrangle-2.html"><a href="data-wrangle-2.html#reshaping-data-with-pivots"><i class="fa fa-check"></i><b>3.1</b> Reshaping data with pivots</a><ul>
<li class="chapter" data-level="3.1.1" data-path="data-wrangle-2.html"><a href="data-wrangle-2.html#tidyrpivot_longer"><i class="fa fa-check"></i><b>3.1.1</b> <code>tidyr::pivot_longer</code></a></li>
<li class="chapter" data-level="3.1.2" data-path="data-wrangle-2.html"><a href="data-wrangle-2.html#tidyrpivot_wider"><i class="fa fa-check"></i><b>3.1.2</b> <code>tidyr::pivot_wider</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>4</b> Functions</a></li>
<li class="chapter" data-level="5" data-path="viz.html"><a href="viz.html"><i class="fa fa-check"></i><b>5</b> Visualistion and communication</a></li>
<li class="chapter" data-level="6" data-path="eda.html"><a href="eda.html"><i class="fa fa-check"></i><b>6</b> Exploratory data analysis</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Coding togetheR</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-wrangle-2" class="section level1">
<h1><span class="header-section-number">3</span> Data wrangling II</h1>
<p>Following on from chapter 2 this lesson deals with some
common tidying problems with data using the <a href="https://tidyr.tidyverse.org/"><code>tidyr</code> package</a> . By the end of this chapter the learner
will:</p>
<ul>
<li>have learnt how to transform rows and columns to reorganise data</li>
<li>have learnt how to join data contained in separate tables into a single table</li>
<li>have learnt some ways to deal with missing values</li>
</ul>
<div id="reshaping-data-with-pivots" class="section level2">
<h2><span class="header-section-number">3.1</span> Reshaping data with pivots</h2>
<p>As you will recall <a href="tidy-data">tidy data</a> means that in a table:</p>
<ol style="list-style-type: decimal">
<li>Every variable has its own column.</li>
<li>Every observation has its own row.</li>
<li>Each value has its own cell.</li>
</ol>
<p>Two common problems making your data untidy are that:</p>
<ol style="list-style-type: decimal">
<li>A single variable is spread across multiple colummns.</li>
<li>A single observation is distributed across multiple rows.</li>
</ol>
<p>In the first case the column names are actually the variable we are
interested in, making our table <strong>wide</strong>.</p>
<p>In the second case, the observation is contained in several rows instead
of a single row, making our table <strong>long</strong>.</p>
<p>Hence <code>tidyr</code> has functions that <strong>pivot</strong> (as in turning) a table from <strong>wide-to-long</strong> by reducing the number of columns and increasing the number of rows. Or from <strong>long-to-wide</strong> by reducing the number of rows and increasing the number of columns.</p>
<p>Usually, the hard part is identifying in a dataset our variables and our
observations, as it is not always obvious which is which.</p>
<div id="tidyrpivot_longer" class="section level3">
<h3><span class="header-section-number">3.1.1</span> <code>tidyr::pivot_longer</code></h3>
<p>First weâ€™ll consider the case when our variable has been recorded as
column names by returning to a version of the <a href="portal-project">Portal surveys data</a>.</p>
<p>A table containing the mean weight of 10 rodent species on each plot from the rodent survey data
can be read directly into a <code>surveys_spread</code> object using the code below.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1">surveys_spread &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/ab604/ab604.github.io/master/docs/surveys_spread.csv&quot;</span>)</a></code></pre></div>
<p>Feel free to explore the data, and snapshot is shown in Figure <a href="data-wrangle-2.html#fig:pivot-long">3.1</a>.</p>
<p>Imagine that we recorded the mean weight of each rodent species on a plot in the field.
It makes sense to put the species as column headings, along with the plot id and
then record the values in each cell.</p>
<p>However, really our variables of interest are the rodent species and our observational
units, the rows, should contain the mean weight for a rodent species in a plot. Hence we
need to reduce the number of columns and create a longer table.</p>
<p>To do this we <code>pivot_longer()</code> by using <code>names_to = "genus"</code> to create a new <code>genus</code>
variable for the exisiting column heading, and <code>values_to = "mean_weight"</code> to create
a variable <code>mean_weight</code> for the values. We put a minus sign before the
variable <code>-plot_id</code> to tell the function not to use these values in the new variable column.</p>

<div class="figure" style="text-align: center"><span id="fig:pivot-long"></span>
<img src="img/pivot_longer_R.png" alt="tidyr::pivot_longer" width="100%" />
<p class="caption">
Figure 3.1: <code>tidyr::pivot_longer</code>
</p>
</div>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1">surveys_spread <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb64-2" title="2"><span class="st">        </span><span class="kw">pivot_longer</span>(<span class="dt">names_to =</span> <span class="st">&quot;genus&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;mean_weight&quot;</span>, <span class="op">-</span>plot_id) </a></code></pre></div>
<pre><code>## # A tibble: 240 x 3
##    plot_id genus           mean_weight
##      &lt;dbl&gt; &lt;chr&gt;                 &lt;dbl&gt;
##  1       1 Baiomys                7   
##  2       1 Chaetodipus           22.2 
##  3       1 Dipodomys             60.2 
##  4       1 Neotoma              156.  
##  5       1 Onychomys             27.7 
##  6       1 Perognathus            9.62
##  7       1 Peromyscus            22.2 
##  8       1 Reithrodontomys       11.4 
##  9       1 Sigmodon              NA   
## 10       1 Spermophilus          NA   
## # ... with 230 more rows</code></pre>
</div>
<div id="tidyrpivot_wider" class="section level3">
<h3><span class="header-section-number">3.1.2</span> <code>tidyr::pivot_wider</code></h3>

<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1">surveys_gw &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/ab604/ab604.github.io/master/docs/surveys_grouped_weight.csv&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:pivot-wider"></span>
<img src="img/pivot_wider_R.png" alt="tidyr::pivot_wider" width="100%" />
<p class="caption">
Figure 3.2: <code>tidyr::pivot_wider</code>
</p>
</div>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1">surveys_gw <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb67-2" title="2"><span class="st">        </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> genus, <span class="dt">values_from =</span> mean_weight) </a></code></pre></div>
<pre><code>## # A tibble: 24 x 11
##    plot_id Baiomys Chaetodipus Dipodomys Neotoma Onychomys Perognathus
##      &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
##  1       1    7           22.2      60.2    156.      27.7        9.62
##  2       2    6           25.1      55.7    169.      26.9        6.95
##  3       3    8.61        24.6      52.0    158.      26.0        7.51
##  4       5    7.75        18.0      51.1    190.      27.0        8.66
##  5      18    9.5         26.8      61.4    149.      26.6        8.62
##  6      19    9.53        26.4      43.3    120       23.8        8.09
##  7      20    6           25.1      65.9    155.      25.2        8.14
##  8      21    6.67        28.2      42.7    138.      24.6        9.19
##  9       4   NA           23.0      57.5    164.      28.1        7.82
## 10       6   NA           24.9      58.6    180.      25.9        7.81
## # ... with 14 more rows, and 4 more variables: Peromyscus &lt;dbl&gt;,
## #   Reithrodontomys &lt;dbl&gt;, Sigmodon &lt;dbl&gt;, Spermophilus &lt;dbl&gt;</code></pre>
<!--  

## Missing values 

As discussed in [R4DS](https://r4ds.had.co.nz/tidy-data.html#missing-values-3) values can be missing in two ways:

+ **Explicitly**, i.e. flagged with NA.
+ **Implicitly**, i.e. simply not present in the data.

## Joining tables

See also [R4DS Relational data chapter](https://r4ds.had.co.nz/relational-data.html)

Previously we've used data from the [Portal project](portal-project) where
everything we needed was already contained within a single table, but often
we have *related* information spread across multiples tables that we want to analyse. 
In these situations we need to join pairs of tables to explore relationships of interest.

> **Note** Joins always use two tables. To add a third relationship it would 
require joining the table created from the first join to another table. And so on.

We can think of three types of join, two of which correspond with `dplyr` verbs:

1. Joins that **mutate** the table. These are joins that create a new variable in one table using
observations from another.
2. Joins that **filter** the table. These are joins that keep only a subset of observations from 
one table based on whether they match the observations in another.
3. Joins that perform **set operations**. These are joins corresponding with the 
mathematical operation of intersection $\cap$, union $\cup$, and difference $-$.

### Keys

A key is a variable or set of variables that uniquely identifies an observation
in a table. In a simple case only one variable is sufficient, but often several variables
are required.

+ Primary key: a key that uniquely identifies the observation in its own table e.g. `record_id` in `surveys` is unique to each set of rodent observations. 
+ Foreign key: a key that uniquely identifies the observation in another table. e.g. if `date` appeared in another table that recorded weather information that we wished to join `surveys` to. The `date` is not unique in `surveys` but it would be in the weather table.

Keys can be both primary and foreign, as they might be primary for one table and foreign in another or vice versa. 

It's a good idea to verify a key is primary i.e. uniquely identifies an observation.
See the examples in [R4DS keys](https://r4ds.had.co.nz/relational-data.html#keys)

If you discover your table lacks a primary key you can add one with `mutate()`.

### Mutating joins

`inner_join()`, `left_join()`, `right_join()` and `full_join()`

The data on the 

### Species

*"`Portal_rodent_species.csv` contains the species codes used in Portal_rodent. Any animal found in a trap is recorded. Non-rodent species are occasionally trapped and so are given species codes. Several columns are also included in the species table to restrict the species list to only rodents, only target species, or only granivores."*

### Rodent adundance data

*"`Portal_rodent.csv` contains the rodent trapping data. Each individual of a target species is PIT tagged and data on species, location caught (plot and stake), sex, reproductive condition, weight, and hindfoot length are recorded. In almost all cases, you will want to remove negative period codes before using this data. Negative period codes indicate data collected outside of the normal census protocols, and should absolutely not be used as regular trapping data."*

The rodent survey data is a good example of 


```r
# Species data
weather <- read_csv("https://raw.githubusercontent.com/weecology/PortalData/master/Weather/Portal_weather.csv",
                    col_types = cols(RH = col_double(),
                                     battv = col_double(),
                                     PTemp_C = col_double(),
                                     BP_mmHg_Avg = col_double(),
                                     SlrkW = col_double(),
                                     SlrMJ_Tot = col_double(),
                                     ETos =col_double(),
                                     Rso = col_double(),
                                     WS_ms_Avg = col_double(),
                                     WindDir  = col_double(),
                                     WS_ms_S_WVT= col_double(),
                                     WindDir_D1_WVT = col_double(),
                                     WindDir_SD1_WVT = col_double(),
                                     HI_C_Avg = col_double(),     
                                     SunHrs_Tot = col_double(),
                                     PotSlrW_Avg = col_double(), 
                                     WC_C_Avg = col_double()
                                     )) %>% 
        mutate(date = make_date(day = day, month = month, year = year)) %>% 
        distinct(date, .keep_all = T)
# Rodent survey data
rodent_data <-  read_csv("https://raw.githubusercontent.com/weecology/PortalData/master/Rodents/Portal_rodent.csv",
                         col_types = cols(tag = col_character(),
                                         prevrt = col_character(),
                                         ltag = col_character(),
                                         note2 = col_character(),
                                         note3 = col_character(), 
                                         note4 = col_character(), 
                                         note5 = col_character())) %>% 
        mutate(date = make_date(day = day, month = month, year = year))
```


```r
#weather %>% count(date) %>% filter(n > 1)
weather %>% inner_join(rodent_data, by = "date") %>% 
        glimpse()
```

```
## Observations: 50,929
## Variables: 55
## $ year.x          <dbl> 1989, 1989, 1989, 1989, 1989, 1989, 1989, 1989...
## $ month.x         <dbl> 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6...
## $ day.x           <dbl> 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4...
## $ hour            <dbl> 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200...
## $ timestamp       <dttm> 1989-06-04 12:00:00, 1989-06-04 12:00:00, 198...
## $ record          <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...
## $ battv           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ PTemp_C         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ airtemp         <dbl> 27.46, 27.46, 27.46, 27.46, 27.46, 27.46, 27.4...
## $ RH              <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ precipitation   <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...
## $ BP_mmHg_Avg     <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ SlrkW           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ SlrMJ_Tot       <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ ETos            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ Rso             <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ WS_ms_Avg       <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ WindDir         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ WS_ms_S_WVT     <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ WindDir_D1_WVT  <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ WindDir_SD1_WVT <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ HI_C_Avg        <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ SunHrs_Tot      <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ PotSlrW_Avg     <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ WC_C_Avg        <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ date            <date> 1989-06-04, 1989-06-04, 1989-06-04, 1989-06-0...
## $ recordID        <dbl> 16156, 16157, 16158, 16159, 16160, 16161, 1616...
## $ month.y         <dbl> 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6...
## $ day.y           <dbl> 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4...
## $ year.y          <dbl> 1989, 1989, 1989, 1989, 1989, 1989, 1989, 1989...
## $ period          <dbl> 135, 135, 135, 135, 135, 135, 135, 135, 135, 1...
## $ plot            <dbl> 4, 7, 3, 3, 4, 8, 14, 2, 3, 13, 9, 3, 2, 4, 8,...
## $ note1           <dbl> NA, NA, NA, NA, 13, NA, NA, 13, NA, NA, NA, NA...
## $ stake           <dbl> 11, 11, 12, 13, 13, 13, 13, 14, 21, 21, 22, 23...
## $ species         <chr> "DM", "RM", "SH", "RM", "SS", "DM", "DM", "SS"...
## $ sex             <chr> "M", "F", "M", "F", NA, "M", "M", NA, "F", "F"...
## $ reprod          <chr> NA, "Z", NA, "Z", NA, "Z", NA, NA, "Z", "Z", N...
## $ age             <chr> NA, NA, "J", NA, NA, NA, NA, NA, NA, NA, NA, "...
## $ testes          <chr> "S", NA, NA, NA, NA, NA, "S", NA, NA, NA, "M",...
## $ vagina          <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ pregnant        <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ nipples         <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ lactation       <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ hfl             <dbl> 37, 17, 32, 16, NA, 36, 37, NA, 33, 15, 21, 29...
## $ wgt             <dbl> 46, 9, 67, 8, NA, 34, 51, NA, 111, 11, 18, 60,...
## $ tag             <chr> "8910", "8783", "8908", "8756", "0", "8760", "...
## $ note2           <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ ltag            <chr> "0", "0", "0", "0", "0", "0", "0", "0", "0", "...
## $ note3           <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ prevrt          <chr> "0", "0", "0", "0", "0", "0", "0", "0", "0", "...
## $ prevlet         <chr> "0", "0", "0", "0", NA, "0", "0", NA, "0", NA,...
## $ nestdir         <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ neststk         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ note4           <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ note5           <chr> NA, "R", NA, NA, NA, NA, NA, NA, NA, NA, NA, N...
```


```r
weather %>% left_join(rodent_data, by = "date") %>% 
        glimpse()
```

```
## Observations: 60,752
## Variables: 55
## $ year.x          <dbl> 1989, 1989, 1989, 1989, 1989, 1989, 1989, 1989...
## $ month.x         <dbl> 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6...
## $ day.x           <dbl> 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4...
## $ hour            <dbl> 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200...
## $ timestamp       <dttm> 1989-06-04 12:00:00, 1989-06-04 12:00:00, 198...
## $ record          <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...
## $ battv           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ PTemp_C         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ airtemp         <dbl> 27.46, 27.46, 27.46, 27.46, 27.46, 27.46, 27.4...
## $ RH              <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ precipitation   <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...
## $ BP_mmHg_Avg     <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ SlrkW           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ SlrMJ_Tot       <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ ETos            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ Rso             <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ WS_ms_Avg       <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ WindDir         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ WS_ms_S_WVT     <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ WindDir_D1_WVT  <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ WindDir_SD1_WVT <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ HI_C_Avg        <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ SunHrs_Tot      <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ PotSlrW_Avg     <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ WC_C_Avg        <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ date            <date> 1989-06-04, 1989-06-04, 1989-06-04, 1989-06-0...
## $ recordID        <dbl> 16156, 16157, 16158, 16159, 16160, 16161, 1616...
## $ month.y         <dbl> 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6...
## $ day.y           <dbl> 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4...
## $ year.y          <dbl> 1989, 1989, 1989, 1989, 1989, 1989, 1989, 1989...
## $ period          <dbl> 135, 135, 135, 135, 135, 135, 135, 135, 135, 1...
## $ plot            <dbl> 4, 7, 3, 3, 4, 8, 14, 2, 3, 13, 9, 3, 2, 4, 8,...
## $ note1           <dbl> NA, NA, NA, NA, 13, NA, NA, 13, NA, NA, NA, NA...
## $ stake           <dbl> 11, 11, 12, 13, 13, 13, 13, 14, 21, 21, 22, 23...
## $ species         <chr> "DM", "RM", "SH", "RM", "SS", "DM", "DM", "SS"...
## $ sex             <chr> "M", "F", "M", "F", NA, "M", "M", NA, "F", "F"...
## $ reprod          <chr> NA, "Z", NA, "Z", NA, "Z", NA, NA, "Z", "Z", N...
## $ age             <chr> NA, NA, "J", NA, NA, NA, NA, NA, NA, NA, NA, "...
## $ testes          <chr> "S", NA, NA, NA, NA, NA, "S", NA, NA, NA, "M",...
## $ vagina          <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ pregnant        <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ nipples         <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ lactation       <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ hfl             <dbl> 37, 17, 32, 16, NA, 36, 37, NA, 33, 15, 21, 29...
## $ wgt             <dbl> 46, 9, 67, 8, NA, 34, 51, NA, 111, 11, 18, 60,...
## $ tag             <chr> "8910", "8783", "8908", "8756", "0", "8760", "...
## $ note2           <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ ltag            <chr> "0", "0", "0", "0", "0", "0", "0", "0", "0", "...
## $ note3           <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ prevrt          <chr> "0", "0", "0", "0", "0", "0", "0", "0", "0", "...
## $ prevlet         <chr> "0", "0", "0", "0", NA, "0", "0", NA, "0", NA,...
## $ nestdir         <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ neststk         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ note4           <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ note5           <chr> NA, "R", NA, NA, NA, NA, NA, NA, NA, NA, NA, N...
```


```r
weather %>% right_join(rodent_data, by = "date") %>% 
        glimpse()
```

```
## Observations: 69,980
## Variables: 55
## $ year.x          <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ month.x         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ day.x           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ hour            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ timestamp       <dttm> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N...
## $ record          <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ battv           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ PTemp_C         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ airtemp         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ RH              <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ precipitation   <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ BP_mmHg_Avg     <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ SlrkW           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ SlrMJ_Tot       <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ ETos            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ Rso             <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ WS_ms_Avg       <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ WindDir         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ WS_ms_S_WVT     <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ WindDir_D1_WVT  <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ WindDir_SD1_WVT <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ HI_C_Avg        <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ SunHrs_Tot      <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ PotSlrW_Avg     <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ WC_C_Avg        <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ date            <date> 1977-07-16, 1977-07-16, 1977-07-16, 1977-07-1...
## $ recordID        <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,...
## $ month.y         <dbl> 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7...
## $ day.y           <dbl> 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16...
## $ year.y          <dbl> 1977, 1977, 1977, 1977, 1977, 1977, 1977, 1977...
## $ period          <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...
## $ plot            <dbl> 2, 3, 2, 7, 3, 1, 2, 1, 1, 6, 5, 7, 3, 8, 6, 4...
## $ note1           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ stake           <dbl> 16, 23, 25, 25, 26, 27, 31, 36, 42, 46, 52, 53...
## $ species         <chr> NA, NA, "DM", "DM", "DM", "PF", "PE", "DM", "D...
## $ sex             <chr> "M", "M", "F", "M", "M", "M", "F", "M", "F", "...
## $ reprod          <chr> "Z", "Z", NA, "Z", "Z", NA, NA, NA, "Z", "Z", ...
## $ age             <chr> NA, NA, NA, NA, NA, "J", NA, NA, NA, NA, NA, N...
## $ testes          <chr> NA, NA, NA, NA, NA, NA, NA, "S", NA, NA, NA, "...
## $ vagina          <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ pregnant        <chr> NA, NA, NA, NA, NA, NA, "P", NA, NA, NA, NA, N...
## $ nipples         <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ lactation       <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ hfl             <dbl> 32, 33, 37, 36, 35, 14, NA, 37, 34, 20, 53, 38...
## $ wgt             <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ tag             <chr> "0", "0", "0", "0", "0", "0", "0", "0", "0", "...
## $ note2           <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ ltag            <chr> "0", "0", "0", "0", "0", "0", "0", "0", "0", "...
## $ note3           <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ prevrt          <chr> "0", "0", "0", "0", "0", "0", "0", "0", "0", "...
## $ prevlet         <chr> "0", "0", "0", "0", "0", "0", "0", "0", "0", "...
## $ nestdir         <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ neststk         <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NA, 0, ...
## $ note4           <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ note5           <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
```


```r
weather %>% full_join(rodent_data, by = "date") %>% 
        glimpse()
```

```
## Observations: 79,803
## Variables: 55
## $ year.x          <dbl> 1989, 1989, 1989, 1989, 1989, 1989, 1989, 1989...
## $ month.x         <dbl> 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6...
## $ day.x           <dbl> 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4...
## $ hour            <dbl> 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200...
## $ timestamp       <dttm> 1989-06-04 12:00:00, 1989-06-04 12:00:00, 198...
## $ record          <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...
## $ battv           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ PTemp_C         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ airtemp         <dbl> 27.46, 27.46, 27.46, 27.46, 27.46, 27.46, 27.4...
## $ RH              <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ precipitation   <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...
## $ BP_mmHg_Avg     <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ SlrkW           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ SlrMJ_Tot       <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ ETos            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ Rso             <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ WS_ms_Avg       <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ WindDir         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ WS_ms_S_WVT     <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ WindDir_D1_WVT  <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ WindDir_SD1_WVT <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ HI_C_Avg        <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ SunHrs_Tot      <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ PotSlrW_Avg     <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ WC_C_Avg        <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ date            <date> 1989-06-04, 1989-06-04, 1989-06-04, 1989-06-0...
## $ recordID        <dbl> 16156, 16157, 16158, 16159, 16160, 16161, 1616...
## $ month.y         <dbl> 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6...
## $ day.y           <dbl> 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4...
## $ year.y          <dbl> 1989, 1989, 1989, 1989, 1989, 1989, 1989, 1989...
## $ period          <dbl> 135, 135, 135, 135, 135, 135, 135, 135, 135, 1...
## $ plot            <dbl> 4, 7, 3, 3, 4, 8, 14, 2, 3, 13, 9, 3, 2, 4, 8,...
## $ note1           <dbl> NA, NA, NA, NA, 13, NA, NA, 13, NA, NA, NA, NA...
## $ stake           <dbl> 11, 11, 12, 13, 13, 13, 13, 14, 21, 21, 22, 23...
## $ species         <chr> "DM", "RM", "SH", "RM", "SS", "DM", "DM", "SS"...
## $ sex             <chr> "M", "F", "M", "F", NA, "M", "M", NA, "F", "F"...
## $ reprod          <chr> NA, "Z", NA, "Z", NA, "Z", NA, NA, "Z", "Z", N...
## $ age             <chr> NA, NA, "J", NA, NA, NA, NA, NA, NA, NA, NA, "...
## $ testes          <chr> "S", NA, NA, NA, NA, NA, "S", NA, NA, NA, "M",...
## $ vagina          <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ pregnant        <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ nipples         <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ lactation       <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ hfl             <dbl> 37, 17, 32, 16, NA, 36, 37, NA, 33, 15, 21, 29...
## $ wgt             <dbl> 46, 9, 67, 8, NA, 34, 51, NA, 111, 11, 18, 60,...
## $ tag             <chr> "8910", "8783", "8908", "8756", "0", "8760", "...
## $ note2           <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ ltag            <chr> "0", "0", "0", "0", "0", "0", "0", "0", "0", "...
## $ note3           <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ prevrt          <chr> "0", "0", "0", "0", "0", "0", "0", "0", "0", "...
## $ prevlet         <chr> "0", "0", "0", "0", NA, "0", "0", NA, "0", NA,...
## $ nestdir         <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ neststk         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ note4           <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
## $ note5           <chr> NA, "R", NA, NA, NA, NA, NA, NA, NA, NA, NA, N...
```
### Filtering joins

`semi_join()` and `anti_join()`

### Set operations

These are joins corresponding with the 
mathematical operation of intersection $\cap$, union $\cup$, and difference $-$.

<img src="img/set-operations.png" width="50%" style="display: block; margin: auto;" />
-->

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-wrangle-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="functions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["coding-together.pdf"],
"toc": {
"collapse": "section"
},
"css": "style.css"
});
});
</script>

</body>

</html>
